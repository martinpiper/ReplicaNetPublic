<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ReplicaNet and RNLobby: RNLobby</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ReplicaNet and RNLobby
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RNLobby </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>The namespace RNLobby provides classes for lobby related functionality broadly related to these areas:</p>
<ul>
<li>Binary difference patch creation and delivery. (RNMakePatches tool / Patcher)</li>
<li>Backend availability and TitleID verification. (RLSrvBackend / BackendServer / BackendClient)</li>
<li>Internet CD/License key verification. (RLSrvCode / CodeServer / CodeClient)</li>
<li>NAT Detection. (RLSrvNATDetect / NATDetectServer / NATDetectClient)</li>
<li>NAT Resolving. (RLSrvNAT / NATResolver) TransportNATUDP for use with XPURL/XPSession/ReplicaNet uses NATResolver.</li>
<li>Advertising and querying of sessions. (RLSrvAdvertise / AdvertiseServer / AdvertiseClient)</li>
<li>User account create/authenticate, friends list, game invites, chat rooms and persistent data storage. (RLSrvUser / UserServer / UserClient)</li>
<li>Statistics and ranking. (RLSrvStat / StatServer / StatClient)</li>
<li>Utility services. (RLSrvUtility / UtilityServer)</li>
</ul>
<h1><a class="anchor" id="components"></a>
Components</h1>
<p>Each component may use the RNLobby.com hosted services or custom user hosted services. <br/>
To use RNLobby NATUDP transports in XPURL, XPSession or ReplicaNet call RNLobby::RegisterDefaultTransports() before allocating any XPURL, XPSession or ReplicaNet instances. The Transport protocol is NATUDP@ and passing this to XPURL::FindTransport(), XPSession::Create() or ReplicaNet::SessionCreate() will cause this transport to be used. <br/>
To use the RNLobby.com hosted servers RNLobby::BackendClient must be used to verify the titleID and encryptionKey. This ensures each components connects to the correct server with the correct internally defined encryption key. When using BackendClient in your own development and test applications use TitleID 1002 and key "ngjfyt64ert" to access the rnlobby.com development server. The rnlobby.com development server is not built to handle many requests and is for small scale tests of less than 64 connections only. The development server may also be restarted for updates without warning. The service status report can be accessed from the following page ( <a href="http://www.rnlobby.com/RLSrvMonitor.html">http://www.rnlobby.com/RLSrvMonitor.html</a> ). Larger scale tests using the RNLobby.com hosted servers must apply to technical support for a dedicated titleID and encryptionKey. User hosting of RNLobby components may also use RNLobby::BackendClient verification using RNLobby::BackendServer, but it is not mandatory to do so. <br/>
NOTE: When using the classes in this library the network stack will be initialised if not already started by other ReplicaNet classes. PlatformHeap::ForceFree() can be used to shutdown the network stack and other internally allocated memory. Using XPURL::ShutdownNetwork(true) or <a class="el" href="XPSocket_8cpp.html#a5317391f903dd67c2e50287ff5d62946">XPSock_Quit()</a> can be used to only shutdown the XPURL or lower level network stack. <br/>
NOTE: This version of RNLobby is in the alpha stage of development and as such may be subject to substantial changes until beta.</p>
<h1><a class="anchor" id="servers"></a>
Pre-built servers</h1>
<p>The Windows pre-built RNLobby servers are available in ReplicaNetPublic. These applications are designed to to be installed as a Windows service or as a DOS command line application. Using a command line of '-?' will display the help for each server. Each application name starts with RLSrv and implements each major RNLobby server component. For example RLSrvAdvertise implements RNLobby::AdvertiseServer. The exception to this rule is RLSrvMonitor which can be configured to regularly create an HTML report of running services, the default output file is RLSrvMonitor although this can be changed by using the -file command line parameter. If these servers are installed as Windows services they are configured to automatically start when Windows starts and to restart if the service encounters a runtime error or exception.<br/>
 For example, if a Windows server is using MySQL and has two IP addresses 1.0.0.1 and 1.0.0.2 then the following commands will configure the RNLobby servers to use their default address and port configurations and start as Windows services. (Two IP addresses are needed for the NATDetectServer to operate correctly.)<br/>
</p>
<ul>
<li>RLSrvMonitor.exe /i /s -file C:\Inetpub\wwwroot\RLSrvMonitor.html</li>
<li>RLSrvBackend.exe /p MySQL /i /s -dstart -addr 0.0.0.0:4001</li>
<li>RLSrvNATDetect.exe /i /s -addr 1.0.0.1:4004 -addr2 1.0.0.1:4005 -addr 1.0.0.2:4006 -addr2 1.0.0.2:4007</li>
<li>RLSrvNAT.exe /i /s -dstart</li>
<li>RLSrvAdvertise.exe /p MySQL /i /s -dstart</li>
<li>RLSrvUser.exe /p MySQL /i /s -dstart</li>
<li>RLSrvStat.exe /p MySQL /i /s -dstart</li>
<li>RLSrvCode.exe /i /s -dstart -file cdkeys.txt</li>
<li>RLSrvUtility.exe /p MySQL /i /s -dstart <br/>
NOTE: The current directory for RL services is the same directory as the executable. RLSrvMonitor will output a report to the current directory if there is no full path given. In this example the path is the wwwroot directory of an IIS server. The servers Backend, Advertise, User and Stat all access the database so these will wait for the MySQL database to start using the /p command. The Code server will need a list of CD keys in the "cdkeys.txt" file. In this example the "cdkeys.txt" file is in the same directory as the service executable.</li>
</ul>
<h1><a class="anchor" id="database"></a>
SQL Database</h1>
<p>Some of the RNLobby server classes use an SQL database (check the class documentation to see if it uses a database) to store information and each class documents any tables used. RNlobby client classes do not require a database to be installed. The RNLobby DB can be prepared by using: RNSQL.exe &lt;ReplicaNetPublic\RNLobby\SQL\CreateTables.sql The RNODBCSQL library is used for database access which implements a wrapper around the ODBC API. Configuring a database is beyond the scope of this documentation however the ODBC Data Source Name (DSN) to use is "RNLobby" (without the quotes). When using Windows the DSN should be a System DSN to allow access to server components that are installed as Windows services. RNLobby has been tested with MySQL Server 5.6.13 with Connector-ODBC 5.2.5 as well as PostgreSQL 9.1.5 with PostgreSQL ODBC Driver v09.02.0100-1. The RNLobby services will automatically detect which database is being used for their SQL queries.<br/>
 For MySQL you will need the database and ODBC connector installs available from <a href="http://www.mysql.com/downloads/mysql/5.1.html">http://www.mysql.com/downloads/mysql/5.1.html</a> and <a href="http://www.mysql.com/downloads/connector/odbc/">http://www.mysql.com/downloads/connector/odbc/</a> <br/>
 The MySQL GUI tools available from <a href="http://www.mysql.com/downloads/workbench/">http://www.mysql.com/downloads/workbench/</a> are also useful.<br/>
 For PostgreSQL download the software from <a href="http://www.postgresql.org/">http://www.postgresql.org/</a> <br/>
</p>
<h1><a class="anchor" id="web"></a>
Web integration</h1>
<p>The RNLobby database can be integrated with a web reporting backend. The RLSrvUtility server is designed to be used by any web server side scripting host such as ASP.</p>
<h1><a class="anchor" id="gamelobby"></a>
GameLobby integration</h1>
<p>The GameLobby (RLHub project and source code in the developer premier package) uses a local host TCP socket to communicate user information with other processes.</p>
<h1><a class="anchor" id="threads"></a>
Thread safety</h1>
<p>Most classes in this library use callbacks to exchange information with the user. During these callbacks the component class mutex may be locked and care must be taken to avoid deadlock situations when calling other user defined classes, especially when user defined classes access the same component class from a different thread.</p>
<h1><a class="anchor" id="usingrnlobby"></a>
Using RNLobby</h1>
<p>RNLobby include files are in the Includes directory "RNLobby/Inc/".<br/>
 To link follow the instructions at <a class="el" href="ReplicaNet.html#usingreplicanet">Using ReplicaNet</a> <br/>
 </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 16 2020 20:08:32 for ReplicaNet and RNLobby by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
